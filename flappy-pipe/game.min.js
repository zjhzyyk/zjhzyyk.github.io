var score=0,vel=7,MyGame={};MyGame.load_state=function(){},MyGame.load_state.prototype={preload:function(){this.load.image("bird","assets/pipe.png"),this.load.atlasJSONHash("pipe","assets/bird.png","assets/bird.json"),this.load.image("background","assets/background.png"),this.load.image("ground","assets/ground.png"),this.load.audio("jump","assets/jump.wav")},create:function(){if(this.game.device.desktop){this.scale.pageAlignHorizontally=!0;var a=document.getElementsByTagName("canvas")[0];a.style.width="480px",a.style.margin="10px auto"}else this.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.forceOrientation(!1,!0),this.scale.pageAlignHorizontally=!0,this.scale.setScreenSize(!0);this.game.state.start("menu")}},MyGame.menu_state=function(){},MyGame.menu_state.prototype={create:function(){this.add.image(0,0,"background"),this.ground=this.add.tileSprite(0,896,this.stage.bounds.width,this.cache.getImage("ground").height,"ground");var a=this.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);a.onDown.add(this.start,this),this.input.onDown.add(this.start,this);var b={font:"60px Arial",fill:"#ffffff"},c=this.world.width/2,d=this.world.height/2,e=this.add.text(c,d-50,"Tap or press space to start",b);if(e.anchor.setTo(.5,.5),score>0){var f=this.add.text(c,d+50,"score: "+score,b);f.anchor.setTo(.5,.5)}},update:function(){this.ground.tilePosition.x-=vel},start:function(){this.state.start("play")}},MyGame.play_state=function(){},MyGame.play_state.prototype={preload:function(){this.load.image("bird","assets/pipe.png"),this.load.atlasJSONHash("pipe","assets/bird.png","assets/bird.json"),this.load.image("background","assets/background.png"),this.load.image("ground","assets/ground.png"),this.load.audio("jump","assets/jump.wav")},create:function(){this.physics.startSystem(Phaser.Physics.ARCADE);var a=this.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);this.add.image(0,0,"background"),a.onDown.add(this.jump,this),this.input.onDown.add(this.jump,this),this.pipes=this.add.group(),this.pipes.enableBody=!0,this.pipes.createMultiple(60,"pipe"),this.ground=this.add.tileSprite(0,896,this.stage.bounds.width,this.cache.getImage("ground").height,"ground"),this.physics.arcade.enable(this.ground),this.timer=this.time.events.loop(1250+-5*score,this.add_row_of_pipes,this),this.bird=this.add.sprite(100,245,"bird"),this.physics.arcade.enable(this.bird),this.bird.body.gravity.y=1800,this.bird.anchor.setTo(-.1,.5),score=0;var b={font:"60px Arial",fill:"#ffffff"};this.label_score=this.add.text(20,20,"0",b),this.jump_sound=this.game.add.audio("jump")},update:function(){0==this.bird.inWorld&&this.restart_game(),this.bird.angle<8&&(this.bird.angle+=1),this.pipes.forEachAlive(function(a){a.x-=vel+.05*score}),this.bird.alive&&(this.ground.tilePosition.x-=vel+.05*score),this.physics.arcade.overlap(this.bird,this.pipes,this.hit_pipe,null,this),this.physics.arcade.overlap(this.bird,this.ground,this.restart_game,null,this)},hit_pipe:function(){0!=this.bird.alive&&(this.bird.alive=!1,this.time.events.remove(this.timer),this.pipes.forEachAlive(function(a){a.alive=!1},this))},restart_game:function(){this.time.events.remove(this.timer),this.state.start("menu")},jump:function(){0!=this.bird.alive&&(this.bird.body.velocity.y=-600,this.add.tween(this.bird).to({angle:-8},100).start())},add_one_pipe:function(a,b){var c=this.pipes.getFirstDead();c.reset(a,b),c.checkWorldBounds=!0,c.outOfBoundsKill=!0,c.animations.add("fly"),c.animations.play("fly",10,!0)},add_row_of_pipes:function(){for(var a=Math.floor(7*Math.random()),b=a;Math.abs(b-a)<3;)b=Math.floor(7*Math.random());for(var c=0;8>c;c++)c!=a&&c!=a+1&&c!=b&&c!=b+1&&this.add_one_pipe(768,110*c+10);score+=1,this.label_score.text=score}},window.onload=function(){var a=new Phaser.Game(768,1024,Phaser.AUTO,"container");a.state.add("load",MyGame.load_state),a.state.add("menu",MyGame.menu_state),a.state.add("play",MyGame.play_state),a.state.start("load")};